# Profile: gmail-test
#
# Goal
# - Run Gmail connectivity tests without requiring a database.
# - This profile is intended for local debugging with GmailFetchTestRunner.
#
# What it does
# - Disables JDBC/JPA/Flyway auto configuration so the app can start even if Postgres is down.
# - Disables Spring AI auto configuration (OpenAI/Anthropic/VectorStore) so missing API keys don't fail startup.

spring:
  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
      - org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration
      - org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration
      - org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration

      # Spring AI: prevent OpenAI/Anthropic/vectorstore beans from being created
      # (they may require API keys/DB connections)
      - org.springframework.ai.autoconfigure.openai.OpenAiAutoConfiguration
      - org.springframework.ai.autoconfigure.anthropic.AnthropicAutoConfiguration
      - org.springframework.ai.autoconfigure.vectorstore.pgvector.PgVectorStoreAutoConfiguration

  # Also prevent Spring Data repositories from initializing.
  data:
    jpa:
      repositories:
        enabled: false

  jpa:
    open-in-view: false

# We explicitly don't touch gmail.enabled here.
# Set it via VM args/env:
# -Dgmail.enabled=true
